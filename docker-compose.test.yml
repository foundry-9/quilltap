version: '3.8'

services:
  test:
    build:
      context: .
      dockerfile: Dockerfile
      target: builder
    container_name: quilltap-test
    environment:
      - NODE_ENV=test
      - NEXTAUTH_SECRET=test-secret-key-minimum-32-characters
      - ENCRYPTION_MASTER_PEPPER=test-pepper-key-minimum-32-chars
      - GOOGLE_CLIENT_ID=test-client-id
      - GOOGLE_CLIENT_SECRET=test-client-secret
      - NEXTAUTH_URL=http://localhost:3000
    command: npm run test:coverage
    networks:
      - quilltap-test-network


networks:
  quilltap-test-network:
    driver: bridge
